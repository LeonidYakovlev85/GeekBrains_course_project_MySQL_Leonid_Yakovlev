# GeekBrains_course_project_MySQL_Leonid_Yakovlev
Course project at the rate of MySQL - a database of purchases of a typical industrial enterprise

База данных purchases_db описание:
База данных содержит в себе данные по закупкам типового промышленного предприятия, имеющего структуру закупок сходную с описанной в ФЗ-223 «О закупках товаров, работ, услуг отдельными видами юридических лиц».

Включает в себя следующие базовые таблицы:
1.	departments – список отделов предприятия;
2.	products_types – типы закупаемой продукции (товары; услуги / работы; etc.);
3.	purchases_types – типы закупок (конкурентные; неконкурентные; etc.);
4.	responsible – список закупщиков, т. е. исполнителей, ответственных за закупку на том или ином этапе;
•	содержит автозаполняемый столбец initials, который создаёт запись из Фамилии и Инициалов исполнителя;
5.	events – основные «события», случающиеся с закупкой во время её жизненного цикла;
6.	stages – основные этапы жизненного цикла закупки.

Включает в себя следующие таблицы, содержащие данные, относящиеся непосредственно о закупке:
1.	procurement_plan – годовой план закупок;
•	связана с таблицами departments; products_types; purchases_types через связь один ко многим, так как отделу, типу товара, типу закупок, etc. может соответствовать неограниченное число записей в procurement_plan;
•	в случае внесения изменений в любую из указанных таблиц данные в procurement_plan меняются автоматически;
2.	other_procurement_register – любой другой реестр закупок. В данном случае – реестр закупок, не предусмотренных годовым планом. При необходимости число таких реестров может быть каким угодно;
•	связана с таблицами departments; products_types; purchases_types через связь один ко многим, так как отделу, типу товара, типу закупок, etc. может соответствовать неограниченное число записей в other_procurement_register;
•	в случае внесения изменений в любую из указанных таблиц данные в other_procurement_register меняются автоматически;
•	при необходимости можно связать её с любыми другими базовыми таблицами;
3.	purchases – сводная таблица, которая включает в себя все закупки в порядке их поступления в закупочный отдел. Объединяет и даёт доступ к закупкам из годового плана и любых других реестров;
•	связана с таблицами procurement_plan; other_procurement_register; через связь один ко многим, так как каждой записи из указанных таблиц может соответствовать несколько записей в таблице purchases, например, когда одна и та же закупка по какой-либо причине проводится несколько раз. Как раз для этого и создана таблица purchases – она позволяет увидеть, когда закупка была, например, отменена и начата во второй, третий, и т. д. разы;
4.	purchase_status – учитывает события и этапы, случающиеся с каждой закупкой из таблицы purchases;
•	связана с таблицами purchases; events; stages; responsible через связь один ко многим, так как каждой записи из указанных таблиц может соответствовать несколько записей в таблице purchase_status;
5.	procurement_documents_register – реестр протоколов и сопоставительных таблиц, оформляемых по результатам закупочного органа;
•	связана с таблицей purchase_status связью один к одному, так как каждому событию из жизненного цикла закупки может соответствовать только одно заседание закупочного органа и, соответственно, только один протокол и сопоставительная таблица;
6.	winners – реестр победителей закупок;
•	связана с таблицей purchases связью один к одному, так как закупка может быть проведена только один раз.

Триггеры:
1.	procurement_plan_before_insert в таблице procurement_plan запрещает указывать дату завершения закупки равную или предшествующую дате начала этой закупки;

Представления:
1.	purchases_full – создаёт таблицу, аналогичную purchases, но заполненную данными, а не индексами. Необходимо для сокращения написания кода при формировании отчётов;
2.	purchase_status_full – создаёт таблицу, аналогичную purchase_status, но заполненную данными, а не индексами. Необходимо для сокращения написания кода при формировании отчётов.

Функции:
1.	last_status_id – определяет id таблицы purchase_status, соответствующий самому позднему событию жизненного цикла закупки. Используется для повышения читабельности кода;
2.	first_status_id – определяет id таблицы purchase_status, соответствующий самому раннему событию жизненного цикла закупки. Используется для повышения читабельности кода;

Запросы:
1.	procurement_plan_per_year – формирует план закупок за указанный год.

Процедуры:
1.	current_purchases – список незавершённых закупок из таблицы purchases с указанием последнего события, текущего этапа, даты его завершения и ответственного исполнителя. Формируется ежедневно, чем и обусловлена реализация в виде процедуры;
2.	procurement_report_per_month – отчёт о завершённых закупках за конкретный месяц. Формируется не реже, чем раз в месяц (на практике чаще), чем и обусловлена реализация в виде процедуры;
3.	procurement_report_per_year – отчёт о завершённых закупках за конкретный год. Реализация в виде процедуры в связи с объёмным кодом;
4.	specific_purchase_report – отчёт о жизненном цикле конкретной закупки. Выполняется нерегулярно, но часто, чем и обусловлена реализация в виде процедуры.
